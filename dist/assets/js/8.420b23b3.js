(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{367:function(s,t,a){s.exports=a.p+"assets/img/img_2.55c6d211.png"},368:function(s,t,a){s.exports=a.p+"assets/img/img_3.d23e5891.png"},369:function(s,t,a){s.exports=a.p+"assets/img/img_4.dbac7a61.png"},370:function(s,t,a){s.exports=a.p+"assets/img/img_5.cd5296ee.png"},371:function(s,t,a){s.exports=a.p+"assets/img/img_6.d1cad1c1.png"},597:function(s,t,a){"use strict";a.r(t);var n=a(18),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"dubbo问题解决"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dubbo问题解决"}},[s._v("#")]),s._v(" dubbo问题解决")]),s._v(" "),n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#前言"}},[s._v("前言")])]),n("li",[n("a",{attrs:{href:"#一-未发现提供者"}},[s._v("一. 未发现提供者")])]),n("li",[n("a",{attrs:{href:"#二-类型转化异常和找不到类"}},[s._v("二. 类型转化异常和找不到类")])]),n("li",[n("a",{attrs:{href:"#三-序列化报错"}},[s._v("三.序列化报错")])])])]),n("p"),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"前言"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),n("p",[n("strong",[s._v("dubbo和openfeign的区别是")]),s._v(":\n"),n("strong",[s._v("dubbo")]),s._v(" 是真正的rpc框架.支持多种通信协议.能面对更多的调用场景,而且跨语言. 它的思路是--\x3e服务暴露自己的方法,注册到注册中心.   消费端则从注册中心调用服务暴露的方法.\n"),n("strong",[s._v("openfeign")]),s._v(" 目的是让开发者调用更简约,因此它是http通信框架.  它的思路是--\x3e服务指定url接口.直接调用目标模块的接口.")]),s._v(" "),n("p",[s._v("我的dubbo提供端和消费端配置\n"),n("img",{attrs:{src:a(367),alt:"在这里插入图片描述"}})]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dubbo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("application")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" vector"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("member "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与服务名一致即可")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("logger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" slf4j\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 元数据中心 local 本地 remote 远程 这里使用远程便于其他服务获取")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意 这里不能使用 本地 local 会读取不到元数据")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadataType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" remote\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置为 tri 即可使用 Triple 3.0 新协议")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 性能对比 dubbo 协议并没有提升 但基于 http2 用于多语言异构等 http 交互场景")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 dubbo 协议通信")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dubbo\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dubbo 协议端口(-1表示自增端口,从20880开始)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("-1")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("serialization")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" hessian2\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("registry")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nacos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//localhost"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8848"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("username=nacos"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&password=nacos")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("check")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata-report")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nacos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//localhost"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8848"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("username=nacos"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&password=nacos")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 1.0.0\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("consumer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 1.0.0\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 禁止消费者启动时检查提供者是否可用")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("check")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])]),n("h2",{attrs:{id:"一-未发现提供者"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一-未发现提供者"}},[s._v("#")]),s._v(" 一. 未发现提供者")]),s._v(" "),n("p",[n("code",[s._v("No provider available for the service.dubbo xxxxxxxx")]),s._v("\n解决方法:   如下图dubbo在启动时会默认检测"),n("code",[s._v("@DubboReference标注的提供端服务是否可用")]),s._v(",不可用则抛出No provider available for the service.dubbo xxxxxxxx. 因此我们只要在consumer禁用检查即可.\n"),n("code",[s._v("这也是两个业务模块互相调用的配置项")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(368),alt:"在这里插入图片描述"}})]),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"二-类型转化异常和找不到类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二-类型转化异常和找不到类"}},[s._v("#")]),s._v(" 二. 类型转化异常和找不到类")]),s._v(" "),n("p",[n("code",[s._v("java.lang.ClassCastException: class java.util.HashMap cannot be cast to class com.vector.score.vo.ArtistVO (java.util.HashMap is in module java.base of loader 'bootstrap'; com.vector.score.vo.ArtistVO is in unnamed module of loader 'app')")])]),s._v(" "),n("p",[s._v("1.这个原因可能是配置了允许序列化泛化调用配置引起的.\n"),n("img",{attrs:{src:a(369),alt:"在这里插入图片描述"}})]),s._v(" "),n("p",[s._v("2.这个错误也可能是dubbo返回变成HashMap一般是生产者与消费者的两个对象不一致导致.没用泛化调用引起的.期间会产生警告:\n"),n("img",{attrs:{src:a(370),alt:"在这里插入图片描述"}}),s._v("\ndubbo会将返回对象变为map. 而map想要操作成对象要深拷贝,不能强转.否则会报错\n原因如下:\n"),n("img",{attrs:{src:a(371),alt:"在这里插入图片描述"}})]),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"三-序列化报错"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三-序列化报错"}},[s._v("#")]),s._v(" 三.序列化报错")]),s._v(" "),n("p",[n("code",[s._v("This serialization only supports google protobuf objects, current object class is: java.lang.Long")]),s._v("\n可以通过debug 观察远程调用结果了解. 该错误是强制类型转化错误. dubbo默认hession2序列化.基本类型不变.但对象传输会变为k-v形式.应该转为map.")]),s._v(" "),n("p",[s._v("倘若使用protobuf 也是不支持对象传输.需要转为map并引入")]),s._v(" "),n("div",{staticClass:"language-xml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[s._v("        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.apache.dubbo"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("dubbo-metadata-definition-protobuf"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("2.7.15"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);